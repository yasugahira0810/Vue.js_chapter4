# 4章 Vue Routerを活用したアプリケーション開発

## *はじめに*

### *注意事項*

- *このリポジトリは[[秋葉原] Vue.js入門 輪読会 4章 Vue Routerを活用した開発 (初心者歓迎！)](https://weeyble-js.connpass.com/event/105884/)の発表資料として用意したリポジトリです。*
- *書籍の要約は正体、担当者の理解で書いているところは斜体で記載しています。*
- *「サンプルあり」と記載のある箇所は、サンプルを動かしながら説明します。*
- *権利関係で問題があれば、対応するのでご指摘ください。*

### 概要

- Vue.jsはシンプルなビュー層のライブラリなので、アプリによってはVue.js単体では実装が難しいことがある。
- 公式プラグインであるVue Routerを使えば、シングルページアプリケーション（以降、SPA）をはじめとしたURL遷移を伴うアプリを実装できる。
- 4章ではVue.jsとVue Routerを使ったアプリの実装方法について述べる。

-------------------


## 4.1 Vue Routerによるシングルページアプリケーション

### 4.1.1 シングルページアプリケーションとルーティング

- SPA: 初めに1つのHTMLをロードし、以降はAjaxを使った非同期通信でページを更新する
- ルーター（ルーティングライブラリ）: SPA実装時の考慮点を担ってくれるモジュール。考慮点は書籍参照。

### 4.1.2 Vue Routerとは

- Vue Router: Vue.js公式のルーティングライブラリ
- 基本機能は、宣言的にページ遷移のルールを定義し、ページ遷移の際にルールに対応するVue.jsのコンポーネントをアクティブにすること
- その他の機能は書籍参照。

-------------------

## 4.2 ルーティングの基礎


### 4.2.1 ルーターのインストール

- Vue.js本体に続けて読み込む。CDN利用すると便利。

### 4.2.2 ルーティング設計

- ルーティングにはルートとルーターコンストラクタを用いる。
- ルーティング実装の流れ
  1. ルーターコンストラクタを作成
  2. ルーターコンストラクタのroutesオプションにルートを定義
  3. Vueインスタンス作成時にrouterインスタンスを設定
- HTML側の設定にはrouter-view要素とrouter-link要素を用いる。
  + router-view: ルート定義で書いたコンポーネントを実際に反映させる要素
  + router-link: リンクを表示してページ遷移を可能にする要素
- [コード](4.2_basics_of_routing.html)
- [デモ](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.2_basics_of_routing.html)

-------------------

## 4.3 実践的なルーティングのための機能

### 4.3.1 URLパラメーターの扱いとパターンマッチング

- *P.258の図を理解することが本節で一番重要な気がする。*
- *WEB+DB PRESS Vol106の「仮想DOM革命」という記事に仮想DOMやFluxアーキテクチャのことが書いてあったので、（難しくて理解が曖昧だが）その内容を踏まえて補足する。*
- *P.258の図に、公式ドキュメントとWEB+DB PRESSの記事を併せて、自分なりの理解として図示したのが下の図。*

![Vuexアーキテクチャ](./vuex_architecture.png)

- *この図で大事なのはComponentがStateを更新したい場合、直接Stateを更新することはできず、間にあるActionsとMutationsを介さないといけないということっぽい。*
- *StateとComponentを双方向に通信させず、ComponentがStateを更新する場合はActionsとMutationsを介すアーキテクチャを取ることで、状態管理が複雑になる問題を解消しているらしい。*
- *Fluxというアーキテクチャが登場するまでは、サーバサイドMVCをクライアント側に適用したクライアントサイドMVCというアーキテクチャが使われていたが、この状態管理の複雑さが深刻な問題だったっぽい。*
- *図のようなアーキテクチャを単方向データフローというらしい。*
- *ストアの要素を「コンポーネントでいうと○○」と説明している箇所が多いので、SECTION06（P.43〜）でオプションの構成を確認しておくと理解しやすい。*

### 4.3.2 名前付きルート

- ストアで管理している状態そのもの。
- コンポーネントでいうところのdata。

### 4.3.3 router.pushを使った遷移

- stateを取得するための算出データ。
- コンポーネントでいうところのcomputed(算出プロパティ)とmethodsの中間のような機能。
- 算出プロパティとの違い
  + 引数を渡せる
  + セッター機能なし
  + 定義するメソッドの引数として使用できるプロパティやメソッドが受け取れる
- getterを介さず直接stateにアクセスすることもできるが、混乱を避けるため常にゲッターを介すのがおすすめ。（*やろうとすれば直接stateにアクセスできる？？？*）

### 4.3.4 フック関数

- ステートを変更できる唯一のメソッド。
- コンポーネントでいうところのmethods。
- ミューテーションおよびアクションのメソッドは「タイプ」と呼ばれる。

-------------------

## 4.4 サンプルアプリケーションの実装

- [コード](4.4.0.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.0.html)

### 4.4.1 リストページの実装

- [コード](./4.4.1.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.1.html)

### 4.4.2 APIによるデータ通信

- [コード](4.4.2.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.2.html)

### 4.4.3 詳細ページの実装

- [コード](4.4.3.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.3.html)

### 4.4.4 ユーザー登録ページの実装

- [コード](4.4.4.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.4.html)

### 4.4.5 ログイン・ログアウトの実装

- [コード](4.4.5.html)
- [動作](https://s3-ap-northeast-1.amazonaws.com/introduction-to-vuejs/4.4.5.html)

### 4.4.6 サンプルアプリケーションの全体像

-------------------

## 4.5 Vue Routerの高度な機能

### モジュールの使い方&同一のミューテーションタイプ

- ストアで管理する情報が増えた場合、ストアを分割することができる。このとき使うのがストアのモジュールオプション。
- ステートはそれぞれのモジュールで管理され、ミューテーションおよびアクションは同一のタイプが定義できる。この場合にコミットをするとすべてのステートに対してタイプが実行される。

### ネームスペース

- 前節で説明した同一のタイプが一括コミットされるのは便利だが、使い分けしたいこともある。
- この場合は、モジュールを定義する際にnamespacedオプションをtrueに設定すればよい。

### モジュールのネスト

### ネームスペース付きモジュールから外部へのアクセス

-------------------

## SECTION46 その他のストアやオプション

### ストアの状態を監視する

### Strictモードで開発する

### Vuexでホットリロードを使用する

-------------------
